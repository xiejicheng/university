- 第二章
  - 物联网的特征
    - 全面感知
    - 可靠传递
    - 智能处理
  - 物联网与传统互联网安全的关系
    - 非全新概念
    - 多了感知层
    - 安全机制可用到物联网
    - 更平民
    - 物联网安全更复杂
  - 物联网安全特点
    - 平民化
    - 轻量级
    - 非对称
    - 复杂性
- 第三章
  - RFID安全威胁分析
    - 电子标签数据的获取攻击
    - 电子标签和读写器之间的通信侵入
    - 侵犯读写器内部的数据
    - 主机系统侵入
  - 安全协议
    - 基于Hash函数的安全通信协议
      - Hash锁协议
        - 在初始化阶段，每个标签有一个ID值，并指定一个随机的Key，计算metalID=Hash(Key)，把ID和metalID存储在标签中。后端数据存储每一个标签的密钥Key，metalID、ID。
        - 优点：标签运算量小，数据库查询块，实现了标签对读写器的认证；
        - 缺点：空中数据不变，明文传递，标签可被跟踪、窃听和克隆；重放攻击、中间人攻击、拒绝服务攻击均可奏效。
      - 随机Hash-Lock协议（采用基于随机数的询问-应答机制。）
        - 标签除HASH函数外，嵌入了伪随机数发生器，后端数据库存储所有标签的ID。阅读器首先查询标签，标签返回一个随机数R和H（IDK|R),阅读器对数据库中的所有标签计算H（IDK|R)，直到找到相同的HASH为止。
        - 优点：解决了标签隐私性问题；实现了阅读器对标签认证        
        - 缺点
          - 1、标签计算两次，工作量大；
          - 2、读写器计算所有ID，计算量大；
          - 3、不能防止重放攻击
          - 4、发送IDk，暴露
    - 基于随机数机制的安全通信协议
    - 基于服务器数据搜索的安全通信协议
      - 基于密钥矩阵的RFID安全协议
        - 协议
          - 1、读写器询问标签
          - 2、标签计算X=K1S，并将其通过阅读器转发给数据库；
          - 3、后端数据库查找X，计算K1-1X，并与数据库中的S比较，若相等则认证通过；然后计算Y=K2S；选取Snew，计算Z=K2 Snew， Xnew=K1Snew，用Snew和Xnew更新数据库字段；把Y、Z通过阅读器转发给标签；
          - 4、标签用Y计算出S认证阅读器，若认证通过，则用Z计算出Snew标更新原S。
        - 优点：
          - 1、数据库搜索速度很快；
          - 2、引入密钥矩阵加密，运算量不大。
        - 缺点：
          - 1、矩阵乘法加密的安全性堪忧，只要一个明文和密文对即可破解密钥；如果用低价矩阵，甚至难以对抗唯密文攻击；
          - 2、两次成功认证之后可跟踪标签；
          - 3、干扰或攻击失步；
          - 4、标签需要更新数据；
          - 5、密钥管理问题。
    - 基于逻辑算法的安全通信协议
    - 基于重加密机制的安全通信协议
    - 基于加密算法的安全认证协议
      - 特点：
        - 在认证过程中采用具有高安全性的加密算法。
        - 加密算法根据安全性要求，可采用对称加密算法（DES、3DE 、AES等），或者采用RSA和ECC等基于公钥机制的加密算法。
        - 主要用于高频RFID安全。
      - “三通互相鉴别”协议
        - 阅读器和电子标签端共享相同的密钥，并采用对称加密算法加密，传递的消息和数据均用随机数和密钥加密。
      - 过程：
        - 1、阅读器发送查询标签；
        - 2、标签产生一个随机数Rt，并回送给阅读器；
        - 3、阅读器则产生另外一个随机数Rr，并使用共同的密钥K，和共同的密码算法EK，算出一个加密数据T1=EK（Rr|Rt|IDr），并将T1发送给标签,顺带读写器的标识；
        - 4、标签解密T1，核对Rt是否正确，若正确，则阅读器通过认证，然后再生成一个随机数Rt2，并计算T2=EK（Rr|Rt2|M），顺带需要传递的信息M，将T2发送给阅读器；
        - 5、阅读器解密T2，核对Rr的正确性，若正确，则标签通过认证。
  - 传感器网络攻击模型
    - 攻击设备
      - 传感器节点
      - 节点网关
      - 应用系统（后台系统）
      - 通信基站
    - 攻击通信链路
      - xx与xx链路之间
  - 传感器网络的安全威胁
    - 干扰
      - 使正常的通信信息丢失或者不可用
    - 截取
      - 获取基站、网关、后台系统等重要信息。
    - 篡改
      - 非授权人对传感器系统的正常数据进行修改，或者，使用非法设备发送大量假的数据包到通信系统中，使节点无法为正常数据提供服务。
    - 假冒
      - 使用非法设备假冒正常设备，参与正常通信，获取信息。
    - 窃听
      - 收集来自感知设备的信息
    - 伪造
      - 仿制具有相同信号的传感器节点
    - 重放
      - 截取合法数据重发，使非法设备合法化，或者诱导其他设备进行特定数据传输，获取敏感数据。
    - 拒绝服务攻击
      - 注入大量的伪造数据包，占用数据带宽，使真正的数据得不到服务。
    - 通信数据流分析攻击
      - 分析通信数据流，使节点瘫痪
    - 物理攻击
      - 拆卸、损坏传感器设备
    - 其他
      - 发射攻击，预言攻击，交叉攻击，代数攻击
  - 传感器网络典型安全技术
    - 链路层安全协议
      - 媒体访问控制协议（MAC）处于WSN的底层
      - S-MAC（节省能量）
      - SSMAC协议
      - 每个MAC子层的帧都由帧头、负载和帧尾三部分构成。
      - 本节的数据链路层的安全是通过SSMAC协议实现，是重点。SSMAC是在S-MAC的基础上，采用NTRU数字签名技术，实现数据的完整性、防抵赖性和防重放攻击。
  - RBRKP（随机密钥预分配模型）介绍
    - 预部署阶段的密钥预分配
      - 利用基站作为权威信任中心拥有P个原始密钥的密钥池，各个传感器节点一个从初始密匙池(initial K set)中随机抽取的G个密钥，构建原始密钥环，同时分配每个节点拥有相同的Hash函数,保证Ri-1=H(Ri)。
    - 初始阶段秘钥分配
      - 基站以不同级别功率发送随机数秘钥Ri ,随机数秘钥Ri覆盖的范围不同，不同区域的节点收到的密钥数量不一样，靠近基站的节点收到的多，节点根据内存限制，保存最初收到的r+1个随机密匙（Rj、 Rj+1、…..、 Rj+r），随后利用Ri=H(Ri+1)，验证广播密钥，随后删除Rj+r，保留最先r个密钥。
    - 用接收的随机数密钥与初始分配的秘钥环
      - 依据K'=H(Ri)*Ki，生成派生秘钥，节点保存的密钥数量是r*G（r代表原有密钥子集数，G代表随机数密钥的个数），这样提高了邻近节点之间相同的密钥数量。删除原来的密钥环和接收的随机数密钥。
      - 这样同一环由于原始密钥环不同，派生密钥也不完全相同，同样原始密钥环相同，在不同的环域，接收的随机数不同，派生密钥也不完全相同。这对网络抗捕获性有好处。
    - 通信阶段的安全链路
      - 派生秘钥个数大于阀值Nc时，Nc≦r*G，才能建立安全的通信链路
    - 两相邻节点间相同密匙发现
      - 密匙池中密匙直接交换匹配容易导致密匙被窃听而泄露，RBRKP利用Merkle谜语发现相同的派生秘钥。
    - 新节点秘钥分发和秘钥的撤销
      - 对新节点装入R个原始秘钥，基站依次重播随机数密匙
    - RBRKP机制中对发射功率没有覆盖的处理
      - 边缘节点接收不到随机数密钥，通过中间传感器节点转发随机数密钥，但恶意节点可能会伪造转发随机数密钥，预部署时，所有节点和基站共享一个密钥K，用密钥K加密随机数密钥进行认证。
    - RBRKP密钥撤销
      - 基站或分离控制器用它与每个传感器唯一共享的密匙K加密撤销消息，通知传感器节点撤销节点派生密匙环中被捕获的派生密匙，
      - RBRKP机制密匙撤销的优点是：由于派生密匙依赖传感器节点的位置，撤销消息发送范围被限制在一定范围内，能节省网络为撤销密匙而耗费的通信开销。
    - RBRKP密匙更新
      - 基站重新广播加密的随机数密钥，各个节点利用原来的派生密钥与新的随机数密钥再派生出新的密钥，删除原来的派生密钥和随机数密钥，更新基站日志。
- 第四章
  - 网络层安全框架
    - 物联网网络层组成
      - 业务网
      - 核心网
      - 接入网
    - 物联网网络层安全解决方案
      - •网络安全体系结构
      - •统一防护平台
      - •安全应用与保障措施
      - •安全接入与应用访问控制机制
    - •现有核心网典型安全防护系统部署
      - 物联网核心网组成
        - •主要是运营商的核心网络
      - 安全通道管控设备
        - •透明
        - •管控
      - LNS(L2TP Network Server)
        - •PPP端系统
      - L2TP (Layer 2 Tunneling Protocol)
        - •基于UDP
      - 物联网AAA服务器
        - •验证访问权限
        - •授权服务
        - •记录网络资源使用情况
      - 网络加密机
        - 安全通道
      - 防火墙
        - 过滤非法服务非法用户
        - 内网外网分开
      - 入侵检测设备
      - 综合安全管理设备
      - 补丁分发服务器
      - 防病毒服务器
      - 漏洞扫描服务器
      - 可扫描的漏洞分类
      - 证书管理系统
      - 应用访问控制设备
      - 应用访问控制设备工作方式
        - 终端设备从安全隧道发来的请求，验证终端设备的身份，查询该终端设备的权限，决定是否允许终端设备的访问
  - 物联网终端安全
    - 移动通信网环境下物联网终端面临的威胁
      - 数据传输安全威胁
        - 未开启加密传输功能，存在空中被截获、篡改的风险
      - 终端数据存储安全
        - 容易被非法读取，存在数据泄露风险
      - 终端丢失/被盗安全威胁
        - 内部数据被窃而给应用业务带来的风险
      - 网络接入安全威胁
      - 外设接口安全威胁
      - 病毒/木马安全威胁
    - 降低终端面临的威胁
      - 硬件设施安全
        - 可信架构
          - •对数据进行加密存储
          - •具备唯一识别性
          - •核心存储芯片采用一次性写入机制
          - •数据存储区的数据修改具备识别和控制机制
        - 安全通信机制
          - •具有合法身份才能接入网络
      - 操作系统安全
        - •安全、可信的工作环境
        - •确保终端操作系统不被恶意代码非法攻击和非法修改
      - 应用安全
        - 通信安全
          - 1.电路域(CS,语音业务)采用端到端加密
          - 2.采用分组域(PS,数据业务)，提供对分组域应用程序的访问控制机制，只有授权应用才能在运行过程中启动分组域连接；
          - 对分组域传输的数据进行监控及支持IPSec安全通道
        - 终端本地数据安全
          - •口令保护
        - 外设接口安全
  - 蓝牙
    - 蓝牙技术
      - 低成本、小功率短距离无线通信
      - 通信距离：1-100m
      - 调频扩展技术 FHSS
        - 无线电收发器按一定的码序列不断地从一个信道跳到另一个信道，只有收发双方是按这个规律进行通信的，而其他的干扰不可能按同样的规律进行干扰。
      - 数据加密和用户鉴别措施
        - 使用个人身份数字（PIN）和蓝牙地址来分辨蓝牙设备
    - 蓝牙协议栈
      - 底层、中间层、应用层
      - 核心协议
        - 1.基带协议
        - 2.链路管理协议 LMP
        - 3.逻辑链路控制LMP和适配协议(L2CAP)
        - 4.服务搜索协议 SDP
    - 蓝牙安全模式
      - 安全模式l（无安全模式）
      - 安全模式2（强制业务）
      - 安全模式3（强制链路）
      - 推荐在通常情况下使用 安全模式 2 
    - 蓝牙的信任分类
      - 被信任的设备
      - 不受信任的设备 
      - 不受信任且不能识别的设备 
    - 蓝牙的安全服务
      - 要求经过认证和授权才能使用的服务
      - 要求经过认证才能使用的服务
      - 开放式的服务
    - 蓝牙的安全框架
      - 设备信息 -> 设备数据库
      - 服务信息 -> 服务数据库
      - 安全管理器
        - 维护设备/服务数据库
        - 响应访问请求
        - 连接前实施认证和加密
        - 处理ESCE的输入（可以是设备、应用程序）建立信任关系
        - 给PIN赋值，响应PIN查询请求
        - 响应来自HCI层的查询请求
    - 蓝牙技术安全机制
      - 跳频
        - 物理层：跳频扩展频谱FHSS
      - 密钥管理（参数）
        - 蓝牙设备地址BD_ADDR
          - 48bit长
          - 唯一MAC地址
        - 私有链接密钥
          - 128bit长
          - 个体密钥
          - 合并密钥
          - 主密钥
          - 初始化密钥
        - 私有加密密钥
          - 8-128bit
        - 一个随机数 RAND
          - 参与密钥生成
      - 认证
        - 单向和双向
        - 验证方检查提出认证请求者是否持有一个共享的对称密钥
        - 拒绝认证请求后认证请求的时间长度越来越长，超过门限值才返回最小值
- 第五章
  - 云计算
    - 将大量用网络连接的计算资源统一管理和调度，构成一个计算资源池向用户按需服务。
    - 层次服务：
      - IaaS 基础设施即服务
      - PaaS 平台即服务
      - SaaS 软件即服务
  - 虚拟化动态迁移技术
    - 采用虚拟机迁移技术可以在某些服务器故障瘫痪时，将业务自动切换到网络其他相同环境的虚拟服务器中，以达到业务连续性目的。